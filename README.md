# RISC-V 操作系统实验项目

本项目基于 **RISC-V 架构**，在 QEMU 模拟器上实现了一系列操作系统核心机制实验，涵盖 **启动流程、内存管理、中断异常、进程调度、系统调用、文件系统以及优先级调度** 等内容。
所有实验均以模块化方式组织，支持按实验编号独立运行，便于调试与验证。

---

## 一、项目运行环境

* **体系结构**：RISC-V 64
* **模拟器**：QEMU（qemu-riscv64）
* **编译工具链**：riscv64-unknown-elf-gcc
* **宿主系统**：Linux（Ubuntu 22.04 测试通过）

---

## 二、项目目录说明（简要）

```
.
├── kernel/          # 内核源码
│   ├── start.c      # 内核入口与实验选择
│   ├── trap/        # 中断与异常处理
│   ├── proc/        # 进程与调度器
│   ├── fs/          # 文件系统实现
│   ├── mm/          # 内存管理
│   └── ...
├── Makefile
└── README.md
```

---

## 三、实验列表说明

本项目共包含 **8 个实验**，每个实验对应一个独立的测试入口函数：

| 实验编号 | 实验内容           |
| ---- | -------------- |
| Lab1 | 串口输出与内核启动验证    |
| Lab2 | printf 实现与边界测试 |
| Lab3 | 物理内存与虚拟内存管理    |
| Lab4 | 时钟中断与异常处理      |
| Lab5 | 进程创建、调度与同步     |
| Lab6 | 系统调用机制         |
| Lab7 | 文件系统与日志恢复      |
| Lab8 | 扩展实验：优先级调度系统   |

---

## 四、运行方式

### 1️⃣ 选择要运行的实验

在 `kernel/boot/start.c` 文件中，找到 `main` 函数，选择要运行的实验：

```c
void main() {
    //lab1_test();
    //lab2_test();
    //lab3_test();
    //lab4_test();
    //lab5_test();
    //lab6_test();
    //lab7_test();
    lab8_test();
}
```
---

### 2️⃣ 编译并运行

在项目根目录下执行：

```bash
make qemu
```

系统将自动完成以下流程：

1. 编译内核代码
2. 启动 QEMU（RISC-V）
3. 加载内核并执行指定实验
4. 在终端输出实验运行结果

---

## 五、输出说明

* 实验运行过程中，所有关键步骤均通过 `printf` 输出
* 不同实验会输出不同的测试日志，例如：

  * 中断触发次数
  * 进程调度顺序
  * 文件读写结果
  * 崩溃恢复前后数据变化
* 若实验正常结束，会输出对应的 **test passed / completed** 信息

---

## 六、注意事项

* 请确保已正确安装 **riscv64-unknown-elf-gcc** 工具链
* QEMU 版本建议 ≥ 7.0
* 实验之间可能依赖不同的子系统初始化，请勿混合调用多个实验函数
* 若出现异常退出，可通过修改实验编号单独调试对应实验

---

## 七、扩展与改进方向

* 支持命令行参数动态选择实验
* 引入自动化测试脚本
* 扩展多级反馈队列（MLFQ）调度器
* 增强文件系统性能与缓存策略

---

## 八、说明

本项目用于操作系统原理与内核实现相关实验，重点在于**理解内核机制与实现思路**，而非完整工业级系统。

---

如果你愿意，我可以帮你再做一件非常“加分”的事：
👉 **把 README 改成课程实验报告附录风格** 或
👉 **给你补一版英文 README（课程/开源仓库通用）**
